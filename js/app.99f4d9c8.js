(function(e){function t(t){for(var o,c,i=t[0],s=t[1],u=t[2],d=0,h=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&h.push(a[c][0]),a[c]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(h.length)h.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(o=!1)}o&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},a={app:0},r=[];function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/acollida/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"10d3":function(e,t,n){},"34c2":function(e,t,n){},3800:function(e,t,n){"use strict";n("ec0a")},"39fe":function(e,t,n){"use strict";n("707d")},"3c0c":function(e,t,n){"use strict";n("10d3")},"3f5d":function(e,t,n){},4764:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23");function a(e,t,n,a,r,c){var i=Object(o["x"])("the-navigation"),s=Object(o["x"])("router-view");return Object(o["p"])(),Object(o["d"])(o["a"],null,[Object(o["g"])(i),Object(o["g"])("main",null,[Object(o["g"])(s)])],64)}n("ac1f"),n("5319"),n("b0c0");var r=Object(o["G"])("data-v-ba80b1c4");Object(o["s"])("data-v-ba80b1c4");var c={class:"main-header"},i={key:0,id:"mySidenav",class:"sidenav"},s=Object(o["f"])("Iniciar sesión"),u=Object(o["f"])("Crear cuenta"),l=Object(o["f"])("Mi cuenta"),d={key:4,class:"year-nav"},h={key:1},m={class:"form-control"},b=Object(o["g"])("label",{for:"newYear"}," Nombre (Ejem.: 2021) ",-1),p={class:"sub-header"},g={class:"menu"},f={class:"app-name"},O=Object(o["f"])("Acollida");Object(o["q"])();var j=r((function(e,t,n,a,j,v){var y=Object(o["x"])("router-link");return Object(o["p"])(),Object(o["d"])("div",c,[j.showNav?(Object(o["p"])(),Object(o["d"])("div",i,[Object(o["g"])("a",{class:"closebtn",onClick:t[1]||(t[1]=function(){return v.openNav&&v.openNav.apply(v,arguments)})},"×"),v.isLoggedIn?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])(y,{key:0,to:"/login",onClick:v.openNav},{default:r((function(){return[s]})),_:1},8,["onClick"])),v.isLoggedIn?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])(y,{key:1,to:"/register",onClick:v.openNav},{default:r((function(){return[u]})),_:1},8,["onClick"])),v.isLoggedIn?(Object(o["p"])(),Object(o["d"])(y,{key:2,to:"/account",onClick:v.openNav},{default:r((function(){return[l]})),_:1},8,["onClick"])):Object(o["e"])("",!0),v.isLoggedIn?(Object(o["p"])(),Object(o["d"])("a",{key:3,class:"logout",onClick:t[2]||(t[2]=function(){return v.logout&&v.logout.apply(v,arguments)})},"Cerrar sesión")):Object(o["e"])("",!0),v.isLoggedIn?(Object(o["p"])(),Object(o["d"])("div",d,[Object(o["g"])("ul",null,[(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(j.years,(function(e){return Object(o["p"])(),Object(o["d"])("li",{key:e.id},[Object(o["g"])("a",null,Object(o["z"])(e.name),1),Object(o["g"])("button",{onClick:function(t){return v.deleteYear(e.name,e.id)}},"borrar",8,["onClick"])])})),128))]),j.showSaveYear?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])("button",{key:0,type:"button",onClick:t[3]||(t[3]=function(){return v.createYear&&v.createYear.apply(v,arguments)})},"Añadir año")),j.showSaveYear?(Object(o["p"])(),Object(o["d"])("div",h,[Object(o["g"])("div",m,[b,Object(o["E"])(Object(o["g"])("input",{type:"number",id:"newYear","onUpdate:modelValue":t[4]||(t[4]=function(e){return j.newYear=e})},null,512),[[o["C"],j.newYear]])]),Object(o["g"])("button",{type:"button",onClick:t[5]||(t[5]=function(){return v.saveYear&&v.saveYear.apply(v,arguments)})},"Guardar")])):Object(o["e"])("",!0)])):Object(o["e"])("",!0)])):Object(o["e"])("",!0),Object(o["g"])("div",p,[Object(o["g"])("div",g,[Object(o["g"])("span",{style:{"font-size":"30px",cursor:"pointer"},onClick:t[6]||(t[6]=function(){return v.openNav&&v.openNav.apply(v,arguments)})},"☰")]),Object(o["g"])("div",f,[Object(o["g"])(y,{style:{"font-size":"30px"},to:"/"},{default:r((function(){return[O]})),_:1})])])])})),v=n("ade3"),y=n("2591"),w=(n("e71f"),{apiKey:"AIzaSyC_RELmap8M_MdOr1ocihwWBme7kOLnEPM",authDomain:"acollida-cddc9.firebaseapp.com",projectId:"acollida-cddc9",storageBucket:"acollida-cddc9.appspot.com",messagingSenderId:"257249030360",appId:"1:257249030360:web:4ca0e0f78c49f13306e7ad",measurementId:"G-4MYQS6H64R"}),k=y["a"].initializeApp(w),I=k,_=I.firestore(),D={name:"TheNavigation",created:function(){this.isLoggedIn&&this.getYearsByUser()},data:function(){return{showNav:!1,years:{},showSaveYear:!1,newYear:""}},computed:{isLoggedIn:function(){return this.$store.getters.isAuthenticated}},methods:{openNav:function(){this.showNav=!1===this.showNav},logout:function(){this.$store.dispatch("logout"),this.$router.replace("/login"),this.openNav()},getYearsByUser:function(){var e=this,t=_.collection("usuarios").doc(this.$store.getters.userId);t.get().then((function(t){t.exists?(console.log("Document data de user:",t.data()),console.log("años: ",t.data().years),e.years=t.data().years):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},createYear:function(){this.showSaveYear=!0},saveYear:function(){var e=this;_.collection("years").add({year:this.newYear,months:{}}).then((function(t){console.log("Document successfully written!",t.id),e.addYearToUser(t.id)})).catch((function(e){console.error("Error writing document: ",e)}))},addYearToUser:function(e){var t=this;_.collection("usuarios").doc(this.$store.getters.userId).set({years:Object(v["a"])({},this.newYear,{id:e,name:this.newYear})},{merge:!0}).then((function(){console.log("Document successfully written year!"),t.showSaveYear=!1,t.getYearsByUser()})).catch((function(e){console.error("Error writing document year: ",e)}))},deleteYear:function(e,t){var n=this;console.log("delete year: ",t),_.collection("years").doc(t).delete().then((function(){console.log("Document successfully deleted!"),n.deleteYearFromUser(e)})).catch((function(e){console.error("Error removing document: ",e)}))},deleteYearFromUser:function(e){console.log(e),delete this.years[e];var t=this.years,n=_.collection("usuarios").doc(this.$store.getters.userId);n.update({years:t},{merge:!0}).then((function(){console.log("Document successfully deleted year!")})).catch((function(e){console.error("Error writing document year: ",e)}))}}};n("7008");D.render=j,D.__scopeId="data-v-ba80b1c4";var Y=D,E={name:"App",components:{TheNavigation:Y},created:function(){this.$store.dispatch("tryLogin")},watch:{didAutoLogout:function(e,t){e&&e!==t&&this.$router.replace("/login")}},computed:{isAuth:function(){return this.$store.getters.userIsAuthenticated},didAutoLogout:function(){return this.$store.getters.didAutoLogout}}};n("b184");E.render=a;var M=E,S=n("6c02"),C=Object(o["G"])("data-v-65c96355"),x=C((function(e,t,n,a,r,c){return Object(o["p"])(),Object(o["d"])("h2",null,"404 page not found.")})),A={name:"NotFound"};A.render=x,A.__scopeId="data-v-65c96355";var U=A,L=Object(o["G"])("data-v-4f82913b");Object(o["s"])("data-v-4f82913b");var P={class:"form-control"},N=Object(o["g"])("label",{for:"email"},"E-mail ",-1),T={class:"form-control"},F=Object(o["g"])("label",{for:"password"},"Password ",-1),z=Object(o["g"])("button",null,"Iniciar sesión",-1);Object(o["q"])();var $=L((function(e,t,n,a,r,c){var i=Object(o["x"])("base-card");return Object(o["p"])(),Object(o["d"])(i,null,{default:L((function(){return[Object(o["g"])("form",{onSubmit:t[3]||(t[3]=Object(o["F"])((function(){return c.submitForm&&c.submitForm.apply(c,arguments)}),["prevent"]))},[Object(o["g"])("div",P,[N,Object(o["E"])(Object(o["g"])("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=function(e){return r.email=e})},null,512),[[o["C"],r.email,void 0,{trim:!0}]])]),Object(o["g"])("div",T,[F,Object(o["E"])(Object(o["g"])("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.password=e})},null,512),[[o["C"],r.password,void 0,{trim:!0}]])]),z],32)]})),_:1})})),K=n("1da1"),V=(n("96cf"),n("caad"),n("2532"),Object(o["G"])("data-v-eee8371a"));Object(o["s"])("data-v-eee8371a");var H={class:"card"};Object(o["q"])();var q=V((function(e,t,n,a,r,c){return Object(o["p"])(),Object(o["d"])("div",H,[Object(o["w"])(e.$slots,"default",{},void 0,!0)])})),G={name:"BaseCard"};n("d4bc");G.render=q,G.__scopeId="data-v-eee8371a";var R=G,B={name:"UserLogin",components:{BaseCard:R},data:function(){return{email:"",password:"",formIsValid:!0,isLoading:!1,error:null}},methods:{submitForm:function(){var e=this;return Object(K["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.formIsValid=!0,""!==e.email&&e.email.includes("@")&&!(e.password.length<6)){t.next=4;break}return e.formIsValid=!1,t.abrupt("return");case 4:return e.isLoading=!0,n={email:e.email,password:e.password},t.prev=6,t.next=9,e.$store.dispatch("login",n);case 9:o="/"+(e.$route.query.redirect||"dashboard"),e.$router.replace(o),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](6),e.error=t.t0.message||"Failed to authenticate, try later.";case 16:e.isLoading=!1;case 17:case"end":return t.stop()}}),t,null,[[6,13]])})))()}}};n("ab90");B.render=$,B.__scopeId="data-v-4f82913b";var W=B,J=Object(o["G"])("data-v-dbfbaaa8");Object(o["s"])("data-v-dbfbaaa8");var Q={class:"form-control"},X=Object(o["g"])("label",{for:"name"}," Nombre ",-1),Z={class:"form-control"},ee=Object(o["g"])("label",{for:"surname"}," Apellido ",-1),te={class:"form-control"},ne=Object(o["g"])("label",{for:"email"},"E-mail ",-1),oe={class:"form-control"},ae=Object(o["g"])("label",{for:"password"},"Password ",-1),re=Object(o["g"])("button",null,"Crear cuenta",-1);Object(o["q"])();var ce=J((function(e,t,n,a,r,c){var i=Object(o["x"])("base-card");return Object(o["p"])(),Object(o["d"])(i,null,{default:J((function(){return[Object(o["g"])("form",{onSubmit:t[5]||(t[5]=Object(o["F"])((function(){return c.submitForm&&c.submitForm.apply(c,arguments)}),["prevent"]))},[Object(o["g"])("div",Q,[X,Object(o["E"])(Object(o["g"])("input",{type:"text",id:"name","onUpdate:modelValue":t[1]||(t[1]=function(e){return r.name=e})},null,512),[[o["C"],r.name,void 0,{trim:!0}]])]),Object(o["g"])("div",Z,[ee,Object(o["E"])(Object(o["g"])("input",{type:"text",id:"surname","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.surname=e})},null,512),[[o["C"],r.surname,void 0,{trim:!0}]])]),Object(o["g"])("div",te,[ne,Object(o["E"])(Object(o["g"])("input",{type:"email",id:"email","onUpdate:modelValue":t[3]||(t[3]=function(e){return r.email=e})},null,512),[[o["C"],r.email,void 0,{trim:!0}]])]),Object(o["g"])("div",oe,[ae,Object(o["E"])(Object(o["g"])("input",{type:"password",id:"password","onUpdate:modelValue":t[4]||(t[4]=function(e){return r.password=e})},null,512),[[o["C"],r.password,void 0,{trim:!0}]])]),re],32)]})),_:1})})),ie=I.firestore(),se={name:"UserRegister",components:{BaseCard:R},data:function(){return{email:"",password:"",name:"",surname:"",formIsValid:!0,isLoading:!1,error:null}},methods:{submitForm:function(){var e=this;return Object(K["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.formIsValid=!0,""!==e.email&&e.email.includes("@")&&!(e.password.length<6)){t.next=4;break}return e.formIsValid=!1,t.abrupt("return");case 4:return e.isLoading=!0,n={email:e.email,password:e.password},t.prev=6,t.next=9,e.$store.dispatch("signup",n);case 9:e.createUser(),o="/"+(e.$route.query.redirect||"dashboard"),e.$router.replace(o),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](6),e.error=t.t0.message||"Failed to authenticate, try later.";case 17:e.isLoading=!1;case 18:case"end":return t.stop()}}),t,null,[[6,14]])})))()},createUser:function(){ie.collection("usuarios").doc(this.$store.getters.userId).set({name:this.name,surname:this.surname,email:this.email,normal_price:2.25,siblings_price:2,final_hour:new Date(Date.UTC("2021","05","06","09","00","00")),years:[]}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))}}};n("3800");se.render=ce,se.__scopeId="data-v-dbfbaaa8";var ue=se,le=Object(o["G"])("data-v-01431d16");Object(o["s"])("data-v-01431d16");var de={class:"title"},he={class:"cards"},me={class:"link-go"},be={key:0},pe={key:1},ge={class:"form-control"},fe=Object(o["g"])("label",{for:"name"}," Nombre (Ejem.: Abril) ",-1),Oe={key:0},je={key:1},ve={class:"form-control"},ye=Object(o["g"])("label",{for:"newYear"}," Nombre (Ejem.: 2021) ",-1);Object(o["q"])();var we=le((function(e,t,n,a,r,c){return Object(o["p"])(),Object(o["d"])(o["a"],null,[Object(o["g"])("h3",de,Object(o["z"])(r.user.year),1),Object(o["g"])("div",he,[(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(r.year.months,(function(e){return Object(o["p"])(),Object(o["d"])("div",{class:"card",onClick:function(t){return c.goToMonth(e.name,e.month_id)},key:e.month_id},[Object(o["g"])("h4",me,Object(o["z"])(e.name),1)],8,["onClick"])})),128)),r.showMonthOptions?(Object(o["p"])(),Object(o["d"])("div",be,[r.showSaveMonth?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])("button",{key:0,type:"button",class:"button-new-element",onClick:t[1]||(t[1]=function(){return c.createMonth&&c.createMonth.apply(c,arguments)})},"Añadir mes")),r.showSaveMonth?(Object(o["p"])(),Object(o["d"])("div",pe,[Object(o["g"])("div",ge,[fe,Object(o["E"])(Object(o["g"])("input",{type:"text",id:"name","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.newMonthName=e})},null,512),[[o["C"],r.newMonthName]])]),Object(o["g"])("button",{type:"button",class:"button-new-element",onClick:t[3]||(t[3]=function(){return c.saveMonth&&c.saveMonth.apply(c,arguments)})},"Guardar")])):Object(o["e"])("",!0)])):Object(o["e"])("",!0)]),r.showYearOptions?(Object(o["p"])(),Object(o["d"])("div",Oe,[r.showSaveYear?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])("button",{key:0,type:"button",class:"button-new-element",onClick:t[4]||(t[4]=function(){return c.createYear&&c.createYear.apply(c,arguments)})},"Añadir año")),r.showSaveYear?(Object(o["p"])(),Object(o["d"])("div",je,[Object(o["g"])("div",ve,[ye,Object(o["E"])(Object(o["g"])("input",{type:"number",id:"newYear","onUpdate:modelValue":t[5]||(t[5]=function(e){return r.newYear=e})},null,512),[[o["C"],r.newYear]])]),Object(o["g"])("button",{type:"button",class:"button-new-element",onClick:t[6]||(t[6]=function(){return c.saveYear&&c.saveYear.apply(c,arguments)})},"Guardar")])):Object(o["e"])("",!0)])):Object(o["e"])("",!0)],64)})),ke=(n("d81d"),I.firestore()),Ie={name:"Dashboard",created:function(){this.getUsers(),this.getCurrentYearData()},data:function(){return{usersList:[],user:{year:"",currentYearId:""},year:{months:[]},showSaveMonth:!1,newMonthName:"",newMonthYear:"",showMonthOptions:!1,showSaveYear:!1,newYear:"",showYearOptions:!1,yearsObject:{}}},methods:{goToMonth:function(e,t){var n=this.user.year;this.$router.push({name:"month",params:{name:e,year:n,monthId:t}})},getUsers:function(){var e=this;console.log("holaaaaa",this.$store.getters.userId);var t=ke.collection("usuarios");t.get().then((function(t){return t.docs.map((function(t){return e.usersList.push({id:t.id,data:t.data()})}))})),console.log(this.usersList)},getCurrentYearData:function(){var e=this,t=ke.collection("usuarios").doc(this.$store.getters.userId);t.get().then((function(t){if(t.exists){console.log("Document data:",t.data()),console.log("TEST",t.data().years),e.yearsObject=t.data().years;var n=[];for(var o in t.data().years)n.push(o);if(console.log("TEST2",n),console.log("TEST3",n[n.length-1]),void 0!==n[n.length-1]){var a=e.yearsObject[n[n.length-1]];console.log("TEST4",a.id),e.user.currentYearId=a.id,console.log("current year",e.user.currentYearId),void 0!==e.user.currentYearId?(e.getYear(),e.showMonthOptions=!0,e.showYearOptions=!1):(e.showMonthOptions=!1,e.showYearOptions=!0)}else e.showMonthOptions=!1,e.showYearOptions=!0}else console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},getYear:function(){var e=this,t=ke.collection("years").doc(this.user.currentYearId);t.get().then((function(t){t.exists?(console.log("Document data:",t.data()),e.user.year=t.data().year,e.year.months=t.data().months,e.newMonthYear=e.user.year):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},createMonth:function(){this.showSaveMonth=!0},createYear:function(){this.showSaveYear=!0},saveMonth:function(){var e=this;ke.collection("months").add({name:this.newMonthName,year:this.newMonthYear,kids:{}}).then((function(t){console.log("Document successfully written!",t.id),e.addMonthToYear(t.id)})).catch((function(e){console.error("Error writing document: ",e)}))},saveYear:function(){var e=this;ke.collection("years").add({year:this.newYear,months:{}}).then((function(t){console.log("Document successfully written!",t.id),e.user.currentYearId=t.id,e.addYearToUser(e.user.currentYearId)})).catch((function(e){console.error("Error writing document: ",e)}))},addMonthToYear:function(e){var t=this;ke.collection("years").doc(this.user.currentYearId).set({months:Object(v["a"])({},e,{month_id:e,name:this.newMonthName})},{merge:!0}).then((function(){console.log("Document successfully written!"),t.showSaveMonth=!1,t.getYear()})).catch((function(e){console.error("Error writing document year: ",e)}))},addYearToUser:function(e){var t=this;console.log("heyyy2",this.user.year),ke.collection("usuarios").doc(this.$store.getters.userId).set({years:Object(v["a"])({},this.newYear,{id:e,name:this.newYear})},{merge:!0}).then((function(){console.log("Document successfully written year!"),t.showSaveMonth=!1,t.showSaveYear=!1,t.getYear(),t.showYearOptions=!1,t.showMonthOptions=!0})).catch((function(e){console.error("Error writing document year: ",e)}))}}};n("cca7");Ie.render=we,Ie.__scopeId="data-v-01431d16";var _e=Ie,De=Object(o["G"])("data-v-4e05a089");Object(o["s"])("data-v-4e05a089");var Ye={class:"my-account"},Ee=Object(o["g"])("h3",null,"Mi cuenta",-1),Me={style:{"font-weight":"bold"}},Se=Object(o["g"])("p",null,"Precio normal",-1),Ce=Object(o["g"])("p",null,"Precio de hermanos",-1),xe=Object(o["g"])("p",null,"Hora finalización",-1);Object(o["q"])();var Ae=De((function(e,t,n,a,r,c){var i=Object(o["x"])("base-card");return Object(o["p"])(),Object(o["d"])("div",Ye,[Ee,Object(o["g"])(i,null,{default:De((function(){return[Object(o["g"])("h4",null,Object(o["z"])(r.user.name)+" "+Object(o["z"])(r.user.surname),1),Object(o["g"])("p",Me,Object(o["z"])(r.user.email),1),Se,Object(o["f"])(" "+Object(o["z"])(r.user.normal_price)+" ",1),Ce,Object(o["f"])(" "+Object(o["z"])(r.user.siblings_price)+" ",1),xe,Object(o["f"])(" "+Object(o["z"])(r.user.final_hour),1)]})),_:1})])})),Ue=I.firestore(),Le={name:"Account",components:{BaseCard:R},data:function(){return{user:{name:"",surname:"",email:"",normal_price:"",siblings_price:"",final_hour:""}}},created:function(){this.getUserData()},methods:{getUserData:function(){var e=this,t=Ue.collection("usuarios").doc(this.$store.getters.userId);t.get().then((function(t){t.exists?(console.log("Document data:",t.data()),e.user=t.data()):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}}};n("c6d4");Le.render=Ae,Le.__scopeId="data-v-4e05a089";var Pe=Le,Ne=Object(o["G"])("data-v-77c1eaa6");Object(o["s"])("data-v-77c1eaa6");var Te={class:"title"},Fe={class:"cards"},ze={key:0,class:"paid"},$e={key:1,class:"paid"},Ke={class:"alumno-name"},Ve={class:"price"},He={key:1},qe={class:"form-control"},Ge=Object(o["g"])("label",{for:"name"}," Nombre ",-1),Re={class:"form-control"},Be=Object(o["g"])("label",{for:"surname"}," Apellido ",-1),We={class:"form-control"},Je=Object(o["g"])("label",{for:"final_hour"}," Hora fin ",-1),Qe={class:"form-control"},Xe=Object(o["g"])("label",{for:"fare"}," Tarifa ",-1);Object(o["q"])();var Ze=Ne((function(e,t,n,a,r,c){return Object(o["p"])(),Object(o["d"])(o["a"],null,[Object(o["g"])("h3",Te,Object(o["z"])(r.monthData.name)+" "+Object(o["z"])(r.monthData.year),1),Object(o["g"])("div",Fe,[(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(r.monthData.kids,(function(e){return Object(o["p"])(),Object(o["d"])("div",{class:["card",{"no-paid-card":!e.paid}],key:e.kid_id,onClick:function(t){return c.goToKid(e.name,e.kid_id)}},[e.paid?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])("p",ze,"No pagado")),e.paid?(Object(o["p"])(),Object(o["d"])("p",$e,"Pagado")):Object(o["e"])("",!0),Object(o["g"])("h4",Ke,Object(o["z"])(e.name)+" "+Object(o["z"])(e.surname),1),Object(o["g"])("p",Ve,"Monto: "+Object(o["z"])(e.total_price)+"€",1)],10,["onClick"])})),128)),r.showSaveKid?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])("button",{key:0,class:"button-new-element",type:"button",onClick:t[1]||(t[1]=function(){return c.createKid&&c.createKid.apply(c,arguments)})},"Añadir niño")),r.showSaveKid?(Object(o["p"])(),Object(o["d"])("div",He,[Object(o["g"])("div",qe,[Ge,Object(o["E"])(Object(o["g"])("input",{type:"text",id:"name","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.newName=e})},null,512),[[o["C"],r.newName]])]),Object(o["g"])("div",Re,[Be,Object(o["E"])(Object(o["g"])("input",{type:"text",id:"surname","onUpdate:modelValue":t[3]||(t[3]=function(e){return r.newSurname=e})},null,512),[[o["C"],r.newSurname]])]),Object(o["g"])("div",We,[Je,Object(o["E"])(Object(o["g"])("input",{type:"time",id:"final_hour","onUpdate:modelValue":t[4]||(t[4]=function(e){return r.newKidFinalHour=e})},null,512),[[o["C"],r.newKidFinalHour]])]),Object(o["g"])("div",Qe,[Xe,Object(o["E"])(Object(o["g"])("input",{type:"number",id:"fare","onUpdate:modelValue":t[5]||(t[5]=function(e){return r.newFare=e})},null,512),[[o["C"],r.newFare]])]),Object(o["g"])("button",{type:"button",onClick:t[6]||(t[6]=function(){return c.saveKid&&c.saveKid.apply(c,arguments)}),class:"button-new-element"},"Guardar")])):Object(o["e"])("",!0)])],64)})),et=I.firestore(),tt={name:"Month",props:["monthId"],created:function(){this.getAlumnosFromMonth(),console.log(this.monthId)},data:function(){return{month:{monthId:""},monthData:{},showSaveKid:!1,newKidFinalHour:"09:00",newName:"",newFare:2.25,newSurname:""}},methods:{goToKid:function(e,t){this.$router.push({name:"kid",params:{name:e,kidId:t,monthId:this.$route.params.monthId}})},getAlumnosFromMonth:function(){var e=this,t=et.collection("months").doc(this.$route.params.monthId);t.get().then((function(t){t.exists?(console.log("Document data:",t.data().kids),e.month.kids=t.data().kids,e.month.monthId=e.monthId,e.monthData=t.data()):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},createKid:function(){this.showSaveKid=!0},saveKid:function(){var e=this;et.collection("kids").add({fare:parseFloat(this.newFare),final_hour:this.newKidFinalHour,name:this.newName,surname:this.newSurname,months:Object(v["a"])({},this.month.monthId,{days:[],month_name:this.monthData.name,month_year:this.monthData.year,paid:!1,total_hours:0,total_minutes:0,total_price:0})}).then((function(t){console.log("Document successfully written!",t.id),e.addKidToMonth(t.id)})).catch((function(e){console.error("Error writing document: ",e)}))},addKidToMonth:function(e){var t=this;et.collection("months").doc(this.month.monthId).set({kids:Object(v["a"])({},e,{kid_id:e,name:this.newName,surname:this.newSurname,paid:!1,total_price:0})},{merge:!0}).then((function(){console.log("Document successfully written!"),t.showSaveKid=!1,t.getAlumnosFromMonth()})).catch((function(e){console.error("Error writing document: ",e)}))}}};n("39fe");tt.render=Ze,tt.__scopeId="data-v-77c1eaa6";var nt=tt,ot=Object(o["G"])("data-v-0c601539");Object(o["s"])("data-v-0c601539");var at={class:"month-data"},rt={class:"kid-name"},ct={class:"info-actualizada"},it={class:"row"},st={class:"column"},ut={class:"column"},lt={class:"form-control"},dt=Object(o["g"])("label",{for:"change_fare"}," Precio Hermanos ",-1),ht={class:"form-control"},mt=Object(o["g"])("label",{for:"change_paid"}," Marcar como pagado",-1),bt={class:"day-container"},pt={class:"styled-table"},gt=Object(o["g"])("thead",null,[Object(o["g"])("tr",null,[Object(o["g"])("th",null,"Dia"),Object(o["g"])("th",null,"Horas"),Object(o["g"])("th",null,"Min."),Object(o["g"])("th",null,"Precio")])],-1),ft={key:1},Ot={class:"form-control"},jt=Object(o["g"])("label",{for:"day"}," Fecha inicio ",-1),vt={class:"form-control"},yt=Object(o["g"])("label",{for:"initial_hour"}," Hora inicio ",-1),wt={class:"form-control"},kt=Object(o["g"])("label",{for:"final_hour"}," Hora fin ",-1);Object(o["q"])();var It=ot((function(e,t,n,a,r,c){var i=Object(o["x"])("day-item"),s=Object(o["x"])("base-card");return Object(o["p"])(),Object(o["d"])(s,null,{default:ot((function(){return[Object(o["g"])("h3",at,Object(o["z"])(r.month.month_name)+" "+Object(o["z"])(r.month.month_year),1),Object(o["g"])("h3",rt,Object(o["z"])(r.kid.name)+" "+Object(o["z"])(r.kid.surname),1),Object(o["g"])("div",ct,[Object(o["g"])("div",it,[Object(o["g"])("div",st,[Object(o["g"])("p",null,"Monto: "+Object(o["z"])(r.month.total_price),1),Object(o["g"])("p",null,"Horas: "+Object(o["z"])(r.month.total_hours),1),Object(o["g"])("p",null,"Minutos: "+Object(o["z"])(r.month.total_minutes),1)]),Object(o["g"])("div",ut,[Object(o["g"])("p",null,"Pagado: "+Object(o["z"])(r.month.paid),1),Object(o["g"])("p",null,"Tarifa: "+Object(o["z"])(r.kid.fare),1),Object(o["g"])("div",lt,[Object(o["E"])(Object(o["g"])("input",{type:"checkbox",id:"change_fare","onUpdate:modelValue":t[1]||(t[1]=function(e){return r.siblingsPrice=e})},null,512),[[o["B"],r.siblingsPrice]]),dt]),Object(o["g"])("div",ht,[Object(o["E"])(Object(o["g"])("input",{type:"checkbox",id:"change_paid","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.isPaid=e})},null,512),[[o["B"],r.isPaid]]),mt])])])]),Object(o["g"])("div",bt,[Object(o["g"])("table",pt,[gt,Object(o["g"])("tbody",null,[(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(r.month.days,(function(e){return Object(o["p"])(),Object(o["d"])(i,{key:e,"day-id_prop":e},null,8,["day-id_prop"])})),128))])])]),r.showSaveDay?Object(o["e"])("",!0):(Object(o["p"])(),Object(o["d"])("button",{key:0,class:"button-new-element",type:"button",onClick:t[3]||(t[3]=function(){return c.createDay&&c.createDay.apply(c,arguments)})},"Añadir dia")),r.showSaveDay?(Object(o["p"])(),Object(o["d"])("div",ft,[Object(o["g"])("div",Ot,[jt,Object(o["E"])(Object(o["g"])("input",{type:"date",id:"day","onUpdate:modelValue":t[4]||(t[4]=function(e){return r.newDayDate=e})},null,512),[[o["C"],r.newDayDate]])]),Object(o["g"])("div",vt,[yt,Object(o["E"])(Object(o["g"])("input",{type:"time",id:"initial_hour","onUpdate:modelValue":t[5]||(t[5]=function(e){return r.newInitialHour=e})},null,512),[[o["C"],r.newInitialHour]])]),Object(o["g"])("div",wt,[kt,Object(o["E"])(Object(o["g"])("input",{type:"time",id:"final_hour","onUpdate:modelValue":t[6]||(t[6]=function(e){return r.newFinalHour=e})},null,512),[[o["C"],r.newFinalHour]])]),Object(o["g"])("button",{class:"button-new-element",type:"button",onClick:t[7]||(t[7]=function(){return c.saveDay&&c.saveDay.apply(c,arguments)})},"Guardar")])):Object(o["e"])("",!0)]})),_:1})})),_t=(n("a15b"),n("1276"),Object(o["G"])("data-v-4cb9b5b2")),Dt=_t((function(e,t,n,a,r,c){return Object(o["p"])(),Object(o["d"])("tr",null,[Object(o["g"])("td",null,Object(o["z"])(r.day.day),1),Object(o["g"])("td",null,Object(o["z"])(r.day.initial_hour)+" - "+Object(o["z"])(r.day.final_hour),1),Object(o["g"])("td",null,Object(o["z"])(r.day.day_minutes),1),Object(o["g"])("td",null,Object(o["z"])(r.day.day_price),1)])})),Yt=I.firestore(),Et={name:"DayItem",props:["dayId_prop"],created:function(){this.dayId=this.dayId_prop,this.getDayData()},data:function(){return{dayId:"",day:""}},methods:{getDayData:function(){var e=this,t=Yt.collection("days").doc(this.dayId);t.get().then((function(t){t.exists?(console.log("Document data day:",t.data()),e.day=t.data()):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}}};n("3c0c");Et.render=Dt,Et.__scopeId="data-v-4cb9b5b2";var Mt=Et,St=I.firestore(),Ct={name:"Kid",props:["kidId","monthId"],components:{BaseCard:R,DayItem:Mt},data:function(){return{kid:"",month:"",showSaveDay:!1,newDayDate:"",newInitialHour:"",newFinalHour:"09:00",newDayMinutes:"",newDayPrice:"",siblingsPrice:!1,isPaid:!1}},created:function(){this.getKid()},watch:{siblingsPrice:function(){!0===this.siblingsPrice?this.kid.fare=2:this.kid.fare=2.25,St.collection("kids").doc(this.$route.params.kidId).set({fare:this.kid.fare},{merge:!0}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))},isPaid:function(){var e=this,t=!1;!0===this.isPaid?(t=!0,this.month.paid=!0):this.month.paid=!1;var n=this.monthId;St.collection("kids").doc(this.$route.params.kidId).set({months:Object(v["a"])({},n,{paid:t})},{merge:!0}).then((function(){console.log("Document successfully written!"),e.isPaid=t,e.setPaid(e.isPaid)})).catch((function(e){console.error("Error writing document: ",e)}))}},methods:{getKid:function(){var e=this,t=St.collection("kids").doc(this.$route.params.kidId);t.get().then((function(t){t.exists?(console.log("Document data kids:",t.data()),e.kid=t.data(),e.month=t.data().months[e.$route.params.monthId],2===e.kid.fare&&(e.siblingsPrice=!0),!0===e.month.paid&&(e.isPaid=!0)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},createDay:function(){this.showSaveDay=!0},dayValues:function(){var e=this.newDayDate;this.newDayDate=e.split(" ")[0].split("-").reverse().join("/");var t=this.newInitialHour,n=this.newFinalHour,o=t.split(":"),a=n.split(":"),r=60*parseInt(o[0])+parseInt(o[1]),c=parseInt(60*a[0])+parseInt(a[1]);this.newDayMinutes=c-r;var i=parseFloat(this.newDayMinutes),s=parseFloat(this.kid.fare);this.newDayPrice=i*(s/60*5)/5},saveDay:function(){var e=this;this.dayValues(),St.collection("days").add({day:this.newDayDate,day_minutes:this.newDayMinutes,day_price:this.newDayPrice,final_hour:this.newFinalHour,initial_hour:this.newInitialHour}).then((function(t){console.log("Document successfully written!",t.id),e.addDayToKid(t.id)})).catch((function(e){console.error("Error writing document: ",e)}))},addDayToKid:function(e){var t=this,n=this.month.days;n.push(e);var o=this.monthId;this.month.total_minutes=parseInt(this.month.total_minutes)+parseInt(this.newDayMinutes);var a=parseInt(this.month.total_minutes)/60,r=parseInt(a),c=60*(a-r);this.month.total_hours=r+":"+c,this.month.total_price=parseFloat(this.month.total_price)+parseFloat(this.newDayPrice),St.collection("kids").doc(this.$route.params.kidId).set({months:Object(v["a"])({},o,{days:n,total_hours:this.month.total_hours,total_minutes:this.month.total_minutes,total_price:this.month.total_price})},{merge:!0}).then((function(){console.log("Document successfully written!"),t.updateKidInMonth(),t.showSaveDay=!1})).catch((function(e){console.error("Error writing document: ",e)}))},updateKidInMonth:function(){St.collection("months").doc(this.monthId).set({kids:Object(v["a"])({},this.$route.params.kidId,{total_price:this.month.total_price})},{merge:!0}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))},setPaid:function(e){St.collection("months").doc(this.monthId).set({kids:Object(v["a"])({},this.$route.params.kidId,{paid:e})},{merge:!0}).then((function(){console.log("Document successfully written Paid!")})).catch((function(e){console.error("Error writing document: ",e)}))}}};n("bcbc");Ct.render=It,Ct.__scopeId="data-v-0c601539";var xt,At=Ct,Ut=n("5502"),Lt={setAuth:function(e,t){e.isLoggedIn=t.isAuth}},Pt={login:function(e){e.commit("setAuth",{isAuth:!0})},logout:function(e){e.commit("setAuth",{isAuth:!1})}},Nt={userIsAuthenticated:function(e){return e.isLoggedIn}},Tt={setUser:function(e,t){e.token=t.token,e.userId=t.userId,e.didAutoLogout=!1},setAutoLogout:function(e){e.didAutoLogout=!0}},Ft=n("5530"),zt=(n("d3b7"),{login:function(e,t){return Object(K["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",e.dispatch("auth",Object(Ft["a"])(Object(Ft["a"])({},t),{},{mode:"login"})));case 1:case"end":return n.stop()}}),n)})))()},signup:function(e,t){return Object(K["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",e.dispatch("auth",Object(Ft["a"])(Object(Ft["a"])({},t),{},{mode:"signup"})));case 1:case"end":return n.stop()}}),n)})))()},auth:function(e,t){return Object(K["a"])(regeneratorRuntime.mark((function n(){var o,a,r,c,i,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.mode,a="https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyC_RELmap8M_MdOr1ocihwWBme7kOLnEPM","signup"===o&&(a="https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyC_RELmap8M_MdOr1ocihwWBme7kOLnEPM"),n.next=5,fetch(a,{method:"POST",body:JSON.stringify({email:t.email,password:t.password,returnSecureToken:!0})});case 5:return r=n.sent,n.next=8,r.json();case 8:if(c=n.sent,r.ok){n.next=13;break}throw console.log(c),i=new Error(c.message||"Failed to authenticate. Check your login data."),i;case 13:s=1e3*+c.expiresIn,u=(new Date).getTime()+s,localStorage.setItem("token",c.idToken),localStorage.setItem("userId",c.localId),localStorage.setItem("tokenExpiration",u),xt=setTimeout((function(){e.dispatch("autoLogout")}),s),console.log(c),console.log("aqui 1"),e.commit("setUser",{token:c.idToken,userId:c.localId}),console.log("valor de token en vuex: ",e.getters.isAuthenticated);case 23:case"end":return n.stop()}}),n)})))()},tryLogin:function(e){var t=localStorage.getItem("token"),n=localStorage.getItem("userId"),o=localStorage.getItem("tokenExpiration"),a=+o-(new Date).getTime();a<0||(xt=setTimeout((function(){e.dispatch("autoLogout")}),a),t&&n&&e.commit("setUser",{token:t,userId:n}))},logout:function(e){localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("tokenExpiration"),clearTimeout(xt),e.commit("setUser",{token:null,userId:null,tokenExpiration:null})},autoLogout:function(e){e.dispatch("logout"),e.commit("setAutoLogout")}}),$t={userId:function(e){return e.userId},token:function(e){return e.token},isAuthenticated:function(e){return!!e.token},didAutoLogout:function(e){return e.didAutoLogout}},Kt={state:function(){return{userId:null,token:null,tokenExpiration:null,didAutoLogout:!1}},mutations:Tt,actions:zt,getters:$t},Vt=Object(Ut["a"])({modules:{auth:Kt},state:function(){return{isLoggedIn:!1}},mutations:Lt,actions:Pt,getters:Nt}),Ht=Vt,qt=Object(S["a"])({history:Object(S["b"])(),base:"/",routes:[{path:"/",redirect:"/dashboard"},{path:"/dashboard",component:_e,meta:{requiresAuth:!0}},{path:"/login",component:W,meta:{requiresUnauth:!0}},{path:"/register",component:ue,meta:{requiresUnauth:!0}},{path:"/account",component:Pe,meta:{requiresAuth:!0}},{path:"/month/:name/:year/:monthId",name:"month",component:nt,props:!0,meta:{requiresAuth:!0}},{path:"/kid/:name/:kidId/:monthId",name:"kid",component:At,props:!0,meta:{requiresAuth:!0}},{path:"/:noFound(.*)",component:U}]});qt.beforeEach((function(e,t,n){console.log("is authenticated",Ht.getters.token),e.meta.requiresAuth&&!Ht.getters.isAuthenticated?n("/login"):e.meta.requiresUnauth&&Ht.getters.isAuthenticated?n("/dashboard"):n()}));var Gt=qt,Rt=Object(o["c"])(M);Rt.use(Gt),Rt.use(Ht),Rt.mount("#app")},6851:function(e,t,n){},7008:function(e,t,n){"use strict";n("34c2")},"707d":function(e,t,n){},9671:function(e,t,n){},a0da:function(e,t,n){},ab90:function(e,t,n){"use strict";n("a0da")},b184:function(e,t,n){"use strict";n("6851")},bcbc:function(e,t,n){"use strict";n("4764")},c6d4:function(e,t,n){"use strict";n("3f5d")},c91b:function(e,t,n){},cca7:function(e,t,n){"use strict";n("9671")},d4bc:function(e,t,n){"use strict";n("c91b")},ec0a:function(e,t,n){}});
//# sourceMappingURL=app.99f4d9c8.js.map